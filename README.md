# Stacker
Stacker is a simple implementation of the open source Musimal email layout design using the Fluent library for building responsive transactional email notifications quickly with minimal markup. 

## Quick Example ##
Create a responsive HTML message body:
```
$config = array(
    'logo'          => 'My App', //Plain text or publicly available URL. Image not wider than 200px
    'color'         => '#ff6600', //Primary colour
    'teaser'        => 'Look at my test', //Text visible in message preview only
    'footer'        => 'My test generated by Fluent Stacker', //Text at bottom of all messages
);

$message = (new Fluent\Message())->create()
    ->title('My little pony')
    ->paragraph('Lorem ipsum dolor sit amet, consectetur adipiscing elit.')
    ->number(['caption' => 'Today', value => date('j M Y')])
    ->button('http://www.mypony.com', 'Like my pony')
    ->paragraph('Pellentesque habitant morbi tristique senectus et netus et malesuada fames.');

$html = Fluent\Factory::layout($message, $options)->render(); 
```

## Sending with mail() ##
Sending a message with PHP's mail() function:
```
$message = (new Stacker\Message())->create()
    ->title('My little pony')
    ->paragraph('Lorem ipsum dolor sit amet, consectetur adipiscing elit.')
    ->number(['caption' => 'Today', value => date('j M Y')])
    ->button('http://www.mypony.com', 'Like my pony')
    ->paragraph('Pellentesque habitant morbi tristique senectus et netus et malesuada fames.')
    ->render();

$headers = [
    'MIME-Version: 1.0',
    'Content-type: text/html; charset=iso-8859-1'
];

mail($to, $subject, $message, implode("\r\n", $headers));
```
## Sending with Fluent ##
The [Fluent Web Service](http://fluentmsg.com) makes email delivery simple and provides a bunch of other helpful features, like 60 day email history, email testing, business friendly license, etc.

To make use of these features, you'll need a [Fluent Web Service](http://fluentmsg.com) account.

```
$config = [
    'key'           => null, // Fluent access key
    'secret'        => null, // Fluent access secret
    'sender'        => null, // Optional default sender
    'headers'       => null, // Optional default sender
];
```

Double action: create and send
```
$messageId = (new Fluent\Message($config))->create()
    ->title('My little pony')
    ->paragraph('Lorem ipsum dolor sit amet, consectetur adipiscing elit.')
    ->send([
        'subject'   => 'Testing it', 
        'recipient' => 'user@theirdomain.com', 
        'sender'    => 'me@myapp.com'
    ]);
```

Create and send expressively:
```
$messageId = (new Fluent\Message($config))->create()
    ->title('My little pony')
    ->paragraph('Lorem ipsum dolor sit amet, consectetur adipiscing elit.')
    ->deliver()
    ->subject('Testing it')
    ->header('Reply-To', 'me@myapp.com')
    ->from('me@myapp.com', 'My App')
    ->to('user@theirdomain.com')
    ->send();
```

## Requirements ##

To implement the above you'll need the following composer packages:
```
composer require fivesqrd/fluent:4.0 fivesqrd/fluent-musimal:1.0
```

